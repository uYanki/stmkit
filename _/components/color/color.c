#include "color.h"

//---------------------------------------------------------------------------
// Definitions
//---------------------------------------------------------------------------

#define LOG_LOCAL_TAG   "color"
#define LOG_LOCAL_LEVEL LOG_LEVEL_INFO

//---------------------------------------------------------------------------
// Prototypes
//---------------------------------------------------------------------------

//---------------------------------------------------------------------------
// Variables
//---------------------------------------------------------------------------

//---------------------------------------------------------------------------
// Functions
//---------------------------------------------------------------------------

void RGB2HSV(rgb_t* rgb, hsv_t* hsv)
{
    float32_t cmax  = MAX3(rgb->r, rgb->g, rgb->b);
    float32_t cmin  = MIN3(rgb->r, rgb->g, rgb->b);
    float32_t delta = cmax - cmin;

    hsv->v = cmax / 255.0 * 100.0;
    hsv->s = cmax ? (delta / cmax) : 0;

    if (delta == 0)
    {
        hsv->h = 0;
    }
    else if (cmax == rgb->r)
    {
        hsv->h = 60 * ((rgb->g - rgb->b) / delta);
    }
    else if (cmax == rgb->g)
    {
        hsv->h = 60 * ((rgb->b - rgb->r) / delta + 2);
    }
    else
    {
        hsv->h = 60 * ((rgb->r - rgb->g) / delta + 4);
    }

    if (hsv->h < 0)
    {
        hsv->h += 360;
    }
}
